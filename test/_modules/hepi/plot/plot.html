<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>hepi.plot.plot &mdash; hepi  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/jupyter-sphinx.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/thebelab.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=eafc0fe6" />

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../../_static/thebelab-helper.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            hepi
          </a>
              <div class="version">
                0.2.19-3-g28a6f936
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/demo_00_resummino.html">Resummino</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/demo_01_write.html">Result writing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/demo_02_interpolate.html">Interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/demo_03_distribute.html">Distribute resummino run files to clusters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/test_feynhiggs.html">Softsusy example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/test_madgraph.html">MadGraph example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/test_nllfast.html">nll-fast</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/test_nnllfast.html">nnll-fast</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/test_softsusy.html">Softsusy example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/test_spheno.html">SPheno example</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Module:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../autoapi/index.html">API Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Versions:</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://hepi.readthedocs.io/en/latest/">RTD</a></li>
<li class="toctree-l1"><a class="reference external" href="https://apn-pucky.github.io/HEPi/">Stable</a></li>
<li class="toctree-l1"><a class="reference external" href="https://apn-pucky.github.io/HEPi/test/">Dev</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Links:</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/APN-Pucky/HEPi">GitHub</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">hepi</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
          <li class="breadcrumb-item"><a href="../../hepi.html">hepi</a></li>
      <li class="breadcrumb-item active">hepi.plot.plot</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for hepi.plot.plot</h1><div class="highlight"><pre>
<span></span>from collections.abc import Iterable

import matplotlib as mpl
import matplotlib.cm as cm
import matplotlib.pyplot as plt
import numpy as np
import pyslha
from matplotlib import colors
from matplotlib.image import NonUniformImage
from matplotlib.ticker import NullFormatter
from scipy import integrate as auc
from scipy.interpolate import BSpline, make_interp_spline
from smpl import plot as splot

from ..input import Input, get_output_dir, replace_macros
from ..particles import get_name


<div class="viewcode-block" id="title">
<a class="viewcode-back" href="../../../autoapi/hepi/plot/plot/index.html#hepi.title">[docs]</a>
def title(
    i: Input,
    axe=None,
    scenario=None,
    diff_L_R=None,
    extra=&quot;&quot;,
    cms_energy=True,
    pdf_info=True,
    id=False,
    **kwargs
):
    &quot;&quot;&quot;Sets the title on axis `axe`.&quot;&quot;&quot;
    if axe is None:
        axe = plt.gca()
    axe.set_title(
        &quot;$pp\\to&quot;
        + get_name(i.particle1)
        + get_name(i.particle2)
        + &quot;$&quot;
        + (&quot; at $\\sqrt{S} = &quot; + str(i.energy / 1000) + &quot;$ TeV&quot; if cms_energy else &quot;&quot;)
        + ((&quot; for &quot; + i.slha.split(&quot;.&quot;)[0]) if scenario is None else (&quot; &quot; +scenario))
        + (&quot; with &quot; + i.pdf_nlo if pdf_info else &quot;&quot;)
        + &quot; &quot;
        + extra
        + ((&quot; [&quot; + i.id + &quot;]&quot;) if id else &quot;&quot;)
    )</div>



<div class="viewcode-block" id="energy_plot">
<a class="viewcode-back" href="../../../autoapi/hepi/plot/plot/index.html#hepi.energy_plot">[docs]</a>
def energy_plot(
    dict_list,
    y,
    yscale=1.0,
    xaxis=&quot;E [GeV]&quot;,
    yaxis=&quot;$\\sigma$ [pb]&quot;,
    label=None,
    **kwargs
):
    &quot;&quot;&quot;Plot energy on the x-axis.&quot;&quot;&quot;
    plot(
        dict_list,
        &quot;energy&quot;,
        y,
        label=label,
        xaxis=xaxis,
        yaxis=yaxis,
        logy=True,
        yscale=yscale,
        **kwargs
    )</div>



<div class="viewcode-block" id="combined_mass_plot">
<a class="viewcode-back" href="../../../autoapi/hepi/plot/plot/index.html#hepi.combined_mass_plot">[docs]</a>
def combined_mass_plot(dict_list, y, part, label=None, **kwargs):
    if label == &quot;&quot;:
        kwargs[&quot;label&quot;] = &quot;&quot;
    mass_plot(
        dict_list,
        y + &quot;_NOERR&quot;,
        part,
        next_color=False,
        fmt=&quot; &quot;,
        fill=False,
        interpolate_label=label,
        **kwargs
    )
    if &quot;label&quot; in kwargs:
        del kwargs[&quot;label&quot;]
    mass_plot(
        dict_list,
        y + &quot;_COMBINED&quot;,
        part,
        next_color=True,
        fit_fmt=&quot; &quot;,
        fill=True,
        label=&quot;&quot;,
        interpolate_lower_uncertainty=False,
        **kwargs
    )</div>



<div class="viewcode-block" id="combined_plot">
<a class="viewcode-back" href="../../../autoapi/hepi/plot/plot/index.html#hepi.combined_plot">[docs]</a>
def combined_plot(dict_list, x, y, label=None, **kwargs):
    if label == &quot;&quot;:
        kwargs[&quot;label&quot;] = &quot;&quot;
    plot(
        dict_list,
        x,
        y + &quot;_NOERR&quot;,
        next_color=False,
        fmt=&quot; &quot;,
        fill=False,
        interpolate_label=label,
        **kwargs
    )
    if &quot;label&quot; in kwargs:
        del kwargs[&quot;label&quot;]
    plot(
        dict_list,
        x,
        y + &quot;_COMBINED&quot;,
        next_color=True,
        fit_fmt=&quot; &quot;,
        fill=True,
        label=&quot;&quot;,
        interpolate_lower_uncertainty=False,
        **kwargs
    )</div>



<div class="viewcode-block" id="mass_plot">
<a class="viewcode-back" href="../../../autoapi/hepi/plot/plot/index.html#hepi.mass_plot">[docs]</a>
def mass_plot(
    dict_list,
    y,
    part,
    logy=True,
    yaxis=&quot;$\\sigma$ [pb]&quot;,
    yscale=1.0,
    label=None,
    xaxis=None,
    **kwargs
):
    if not &quot;mass_&quot; + str(part) in dict_list:
        dict_list[&quot;mass_&quot; + str(part)] = get_mass(dict_list, abs(part))
    if xaxis is None:
        xaxis = &quot;$m_{&quot; + get_name(part) + &quot;}$ [GeV]&quot;
    plot(
        dict_list,
        &quot;mass_&quot; + str(part),
        y,
        label=label,
        yaxis=yaxis,
        xaxis=xaxis,
        logy=logy,
        yscale=yscale,
        **kwargs
    )</div>



<div class="viewcode-block" id="mass_vplot">
<a class="viewcode-back" href="../../../autoapi/hepi/plot/plot/index.html#hepi.mass_vplot">[docs]</a>
def mass_vplot(
    dict_list,
    y,
    part,
    logy=True,
    yaxis=&quot;$\\sigma$ [pb]&quot;,
    yscale=1.0,
    label=None,
    mask=None,
    **kwargs
):
    vplot(
        get_mass(dict_list, part)[mask],
        y[mask],
        label=label,
        xaxis=&quot;$m_{&quot; + get_name(part) + &quot;}$ [GeV]&quot;,
        yaxis=yaxis,
        logy=logy,
        yscale=yscale,
        mask=mask,
        **kwargs
    )</div>



<div class="viewcode-block" id="get_mass">
<a class="viewcode-back" href="../../../autoapi/hepi/plot/plot/index.html#hepi.get_mass">[docs]</a>
def get_mass(l: dict, iid: int):
    &quot;&quot;&quot;
    Get the mass of particle with id `iid` out of the list in the &quot;slha&quot; element in the dict.

    Returns
        :obj:`list` of float : masses of particles in each element of the dict list.

    &quot;&quot;&quot;
    ret = []
    for s in l[&quot;slha&quot;]:
        d = pyslha.read(get_output_dir() + s)
        ret.append(d.blocks[&quot;MASS&quot;][abs(iid)])

    return np.array(ret)</div>



<div class="viewcode-block" id="plot">
<a class="viewcode-back" href="../../../autoapi/hepi/plot/plot/index.html#hepi.plot">[docs]</a>
def plot(
    dict_list,
    x,
    y,
    label=None,
    xaxis=&quot;M [GeV]&quot;,
    yaxis=&quot;$\\sigma$ [pb]&quot;,
    ratio=False,
    K=False,
    K_plus_1=False,
    logy=True,
    yscale=1.0,
    mask=None,
    **kwargs
) -&gt; None:
    &quot;&quot;&quot;
    Creates a plot based on the entries `x`and `y` in `dict_list`.

    Examples

    .. plot::
        :include-source:

        &gt;&gt;&gt; import urllib.request
        &gt;&gt;&gt; import hepi
        &gt;&gt;&gt; dl = hepi.load(urllib.request.urlopen(
        ... &quot;https://raw.githubusercontent.com/fuenfundachtzig/xsec/master/json/pp13_hino_NLO%2BNLL.json&quot;
        ... ))
        &gt;&gt;&gt; hepi.plot(dl,&quot;N1&quot;,&quot;NLO_PLUS_NLL_COMBINED&quot;,xaxis=&quot;$m_{\\\\tilde{\\\\chi}_1^0}$ [GeV]&quot;)
    &quot;&quot;&quot;
    if isinstance(y, Iterable) and not isinstance(y, str):
        for yi in y:
            plot(
                dict_list,
                x,
                yi,
                label,
                xaxis,
                yaxis,
                ratio,
                K,
                K_plus_1,
                logy,
                yscale,
                mask,
                **kwargs
            )
        return
    # TODO use kwargs
    if label is None:
        label = y.replace(&quot;_PLUS_&quot;, &quot;+&quot;).replace(&quot;_OVER_&quot;, &quot;/&quot;)
    if label == &quot;&quot;:
        label = None

    vx = dict_list[x].to_numpy()[mask]
    vy = dict_list[y].to_numpy()[mask]

    if K:
        yaxis = &quot;$K$&quot;
        yscale = 1.0
        vy = vy / splot.unv(dict_list[&quot;LO&quot;].to_numpy()[mask])
        if K_plus_1:
            vy = vy + vy / vy
    if ratio:
        yaxis = &quot;Ratio&quot;
        yscale = 1.0
        vy = vy / splot.unv(vy)

    vplot(vx, vy, label, xaxis, yaxis, logy, yscale, mask=mask, **kwargs)</div>



<div class="viewcode-block" id="index_open">
<a class="viewcode-back" href="../../../autoapi/hepi/plot/plot/index.html#hepi.index_open">[docs]</a>
def index_open(var, idx):
    if len(idx) == 1:
        return var[idx]
    return index_open(var[idx[0]], idx[1:])</div>



<div class="viewcode-block" id="slha_data">
<a class="viewcode-back" href="../../../autoapi/hepi/plot/plot/index.html#hepi.slha_data">[docs]</a>
def slha_data(li, index_list):
    vx = []
    for l in li:
        b = pyslha.read(get_output_dir() + l.slha)
        vx.append(index_open(b.blocks, index_list))
    return np.array(vx)</div>



<div class="viewcode-block" id="slha_plot">
<a class="viewcode-back" href="../../../autoapi/hepi/plot/plot/index.html#hepi.slha_plot">[docs]</a>
def slha_plot(li, x, y, **kwargs):
    vx = slha_data(li, x)
    vy = slha_data(li, y)

    vplot(np.array(vx), np.array(vy), **kwargs)</div>



<div class="viewcode-block" id="vplot">
<a class="viewcode-back" href="../../../autoapi/hepi/plot/plot/index.html#hepi.vplot">[docs]</a>
def vplot(
    x,
    y,
    label=None,
    xaxis=&quot;E [GeV]&quot;,
    yaxis=&quot;$\\sigma$ [pb]&quot;,
    logy=True,
    yscale=1.0,
    interpolate=True,
    plot_data=True,
    data_color=None,
    mask=-1,
    fill=False,
    data_fmt=&quot;.&quot;,
    fmt=&quot;-&quot;,
    print_area=False,
    sort=True,
    **kwargs
):
    &quot;&quot;&quot;
    Creates a plot based on the values in `x`and `y`.

    &quot;&quot;&quot;
    color = data_color
    if label is None:
        # label = &quot;??&quot;
        pass
    if mask is None:
        x = x[0]
        y = y[0]
    if sort:
        permute = x.argsort(kind=&quot;stable&quot;)
        vx = x[permute]
        vy = y[permute]
    else:
        vx = x
        vy = y

    if data_color is None and &quot;next_color&quot; not in kwargs:
        if &quot;axes&quot; in kwargs and kwargs[&quot;axes&quot;] is not None:
            (bl,) = kwargs[&quot;axes&quot;].plot([], [])
        else:
            (bl,) = plt.gca().plot([], [])
        color = bl.get_color()
    iii = splot.data(
        vx,
        vy * yscale,
        label=label,
        xaxis=xaxis,
        yaxis=yaxis,
        logy=logy,
        data_color=color,
        fit_color=color,
        also_data=plot_data,
        interpolate=interpolate,
        fmt=data_fmt,
        sigmas=0 if not fill else 1,
        **kwargs
    )
    if iii is not None:
        # ii = iii[0]
        ix = iii[1]
        iy = iii[2]
    if print_area:
        print(
            &quot;computed AUC using scipy.integrate.simpson: {}&quot;.format(auc.simpson(iy, ix))
        )
    if (np.any(np.less(vy, 0)) or (interpolate and np.any(np.less(iy, 0)))) and logy:
        splot.data(
            vx,
            -vy * yscale,
            label=&quot;-&quot; + label,
            xaxis=xaxis,
            yaxis=yaxis,
            logy=logy,
            data_color=color,
            fit_color=color,
            also_data=plot_data,
            interpolate=interpolate,
            interpolate_fmt=(0, (3, 1, 3, 1, 1, 1)),
            fmt=data_fmt,
            sigmas=0 if not fill else 1,
            **kwargs
        )</div>



<div class="viewcode-block" id="mass_mapplot">
<a class="viewcode-back" href="../../../autoapi/hepi/plot/plot/index.html#hepi.mass_mapplot">[docs]</a>
def mass_mapplot(
    dict_list,
    part1,
    part2,
    z,
    logz=True,
    zaxis=&quot;$\\sigma$ [pb]&quot;,
    zscale=1.0,
    label=None,
):
    mapplot(
        dict_list,
        &quot;mass_&quot; + str(part1),
        &quot;mass_&quot; + str(part2),
        z,
        xaxis=&quot;$M_{&quot; + get_name(part1) + &quot;}$ [GeV]&quot;,
        yaxis=&quot;$M_{&quot; + get_name(part2) + &quot;}$ [GeV]&quot;,
        zaxis=zaxis,
        logz=logz,
        zscale=zscale,
    )</div>



<div class="viewcode-block" id="mapplot">
<a class="viewcode-back" href="../../../autoapi/hepi/plot/plot/index.html#hepi.mapplot">[docs]</a>
def mapplot(dict_list, x, y, z, xaxis=None, yaxis=None, zaxis=None, **kwargs):
    &quot;&quot;&quot;

    Examples

    .. plot::
        :include-source:

        &gt;&gt;&gt; import urllib.request
        &gt;&gt;&gt; import hepi

        &gt;&gt;&gt; dl = hepi.load(urllib.request.urlopen(
        ... &quot;https://raw.githubusercontent.com/APN-Pucky/xsec/master/json/pp13_SGmodel_GGxsec_NLO%2BNLL.json&quot;
        ... ),dimensions=2)
        &gt;&gt;&gt; hepi.mapplot(dl,&quot;gl&quot;,&quot;sq&quot;,&quot;NLO_PLUS_NLL_COMBINED&quot;,xaxis=&quot;$m_{\\\\tilde{g}}$ [GeV]&quot;,yaxis=&quot;$m_{\\\\tilde{q}}$ [GeV]&quot; , zaxis=&quot;$\\\\sigma_{\\\\mathrm{NLO+NLL}}$ [pb]&quot;)
    &quot;&quot;&quot;
    if xaxis is None:
        xaxis = x
    if yaxis is None:
        yaxis = y
    if zaxis is None:
        zaxis = replace_macros(z)
    vx = dict_list[x]
    vy = dict_list[y]
    vz = dict_list[z]
    splot.plot2d(
        vx, vy, vz, style=&quot;pcolormesh&quot;, xaxis=xaxis, yaxis=yaxis, zaxis=zaxis, **kwargs
    )</div>



<div class="viewcode-block" id="map_vplot">
<a class="viewcode-back" href="../../../autoapi/hepi/plot/plot/index.html#hepi.map_vplot">[docs]</a>
map_vplot = lambda *a, **da: splot.plot2d(*a, style=&quot;pcolormesh&quot;, **da)</div>

<div class="viewcode-block" id="scatter_vplot">
<a class="viewcode-back" href="../../../autoapi/hepi/plot/plot/index.html#hepi.scatter_vplot">[docs]</a>
scatter_vplot = lambda *a, **da: splot.plot2d(*a, style=&quot;scatter&quot;, **da)</div>



<div class="viewcode-block" id="scatterplot">
<a class="viewcode-back" href="../../../autoapi/hepi/plot/plot/index.html#hepi.scatterplot">[docs]</a>
def scatterplot(dict_list, x, y, z, xaxis=None, yaxis=None, zaxis=None, **kwargs):
    &quot;&quot;&quot;
    Scatter map 2d.
    Central color is the central value, while the inner and outer ring are lower and upper bounds of the uncertainty interval.

    Examples

    .. plot::
        :include-source:

        &gt;&gt;&gt; import urllib.request
        &gt;&gt;&gt; import hepi
        &gt;&gt;&gt; dl = hepi.load(urllib.request.urlopen(
        ... &quot;https://raw.githubusercontent.com/APN-Pucky/xsec/master/json/pp13_hinosplit_N2N1_NLO%2BNLL.json&quot;
        ... ),dimensions=2)
        &gt;&gt;&gt; hepi.scatterplot(dl,&quot;N1&quot;,&quot;N2&quot;,&quot;NLO_PLUS_NLL_COMBINED&quot;,xaxis=&quot;$m_{\\\\tilde{\\\\chi}_1^0}$ [GeV]&quot;,yaxis=&quot;$m_{\\\\tilde{\\\\chi}_2^0}$ [GeV]&quot; , zaxis=&quot;$\\\\sigma_{\\\\mathrm{NLO+NLL}}$ [pb]&quot;)

    &quot;&quot;&quot;
    if xaxis is None:
        xaxis = x
    if yaxis is None:
        yaxis = y
    if zaxis is None:
        zaxis = replace_macros(z)
    vx = dict_list[x]
    vy = dict_list[y]
    vz = dict_list[z]
    splot.plot2d(
        vx, vy, vz, style=&quot;scatter&quot;, xaxis=xaxis, yaxis=yaxis, zaxis=zaxis, **kwargs
    )</div>



<div class="viewcode-block" id="fig">
<a class="viewcode-back" href="../../../autoapi/hepi/plot/plot/index.html#hepi.fig">[docs]</a>
fig = None</div>

<div class="viewcode-block" id="axs">
<a class="viewcode-back" href="../../../autoapi/hepi/plot/plot/index.html#hepi.axs">[docs]</a>
axs = None</div>

<div class="viewcode-block" id="lines">
<a class="viewcode-back" href="../../../autoapi/hepi/plot/plot/index.html#hepi.lines">[docs]</a>
lines = []</div>

<div class="viewcode-block" id="labels">
<a class="viewcode-back" href="../../../autoapi/hepi/plot/plot/index.html#hepi.labels">[docs]</a>
labels = []</div>



<div class="viewcode-block" id="err_plt">
<a class="viewcode-back" href="../../../autoapi/hepi/plot/plot/index.html#hepi.err_plt">[docs]</a>
def err_plt(axes, x, y, label=None, error=False):
    v = label
    ind = np.argsort(splot.unv(x), kind=&quot;stable&quot;)
    if error:
        l, _, _ = axes.errorbar(
            x.to_numpy()[ind], splot.unv(y)[ind], yerr=splot.usd(y), capsize=5, label=v
        )
        return l
    else:
        l = axes.plot(x.to_numpy()[ind], splot.unv(y)[ind], label=v)
        return l[0]</div>



<div class="viewcode-block" id="scale_plot">
<a class="viewcode-back" href="../../../autoapi/hepi/plot/plot/index.html#hepi.scale_plot">[docs]</a>
def scale_plot(
    dict_list,
    vl,
    seven_point_band=False,
    cont=False,
    error=True,
    li=None,
    plehn_color=False,
    yscale=1.0,
    unit=&quot;pb&quot;,
    yaxis=None,
    **kwargs
):
    &quot;&quot;&quot;Creates a scale variance plot with 5 panels (xline).&quot;&quot;&quot;
    global fig, axs, lines, labels
    cycle_safe = mpl.rcParams[&quot;axes.prop_cycle&quot;]
    if plehn_color:
        mpl.rcParams[&quot;axes.prop_cycle&quot;] = mpl.cycler(color=[&quot;b&quot;, &quot;r&quot;, &quot;g&quot;])
    if not cont:
        fig, axs = plt.subplots(1, 5, figsize=(12, 3), sharey=True)
        # Remove horizontal space between axes
        fig.subplots_adjust(wspace=0)
        if li is not None:
            title(axs[2], li[0], **kwargs)

    mr = dict_list[&quot;mu_r&quot;]
    mf = dict_list[&quot;mu_f&quot;]

    if not cont:
        lines = []
        labels = []
        axs[0].plot([], [], &quot; &quot;, color=&quot;k&quot;, label=&quot;$\\mu_R=&quot; + &quot;\\mu_F$&quot;)
        axs[1].plot(
            [], [], &quot; &quot;, color=&quot;k&quot;, label=&quot;$\\mu_R=&quot; + str(np.max(mr)) + &quot;\\mu_0$&quot;
        )
        axs[2].plot(
            [], [], &quot; &quot;, color=&quot;k&quot;, label=&quot;$\\mu_F=&quot; + str(np.min(mf)) + &quot;\\mu_0$&quot;
        )
        axs[3].plot(
            [], [], &quot; &quot;, color=&quot;k&quot;, label=&quot;$\\mu_R=&quot; + str(np.min(mr)) + &quot;\\mu_0$&quot;
        )
        axs[4].plot(
            [], [], &quot; &quot;, color=&quot;k&quot;, label=&quot;$\\mu_F=&quot; + str(np.max(mf)) + &quot;\\mu_0$&quot;
        )

    for v in vl:
        mv = dict_list[v] * yscale
        if seven_point_band:
            # mask = (mf/mr &lt; 4.) &amp; (mf/mr &gt; 1./4.) &amp; (mf &lt;= 2) &amp; (mf &gt;= 1./2.) &amp; (mr &lt;= 2) &amp; (mr &gt;= 1./2.)
            mask = (
                ((mf == 2.0) &amp; (mr == 2.0))
                | ((mf == 2.0) &amp; (mr == 1.0))
                | ((mf == 1.0) &amp; (mr == 1.0))
                | ((mf == 1.0) &amp; (mr == 2.0))
                | ((mf == 1 / 2.0) &amp; (mr == 1 / 2.0))
                | ((mf == 1 / 2.0) &amp; (mr == 1.0))
                | ((mf == 1.0) &amp; (mr == 1 / 2.0))
            )
            mvmax = np.max(splot.unv(mv[mask]))
            mvmin = np.min(splot.unv(mv[mask]))

        mask = mf == mr
        l = err_plt(axs[0], mf[mask], mv[mask], error=error)
        # l, _, _ = axs[0].errorbar(mf[mask], splot.unv(mv[mask]),
        #                          yerr=splot.usd(mv[mask]), capsize=5, label=v)
        if seven_point_band:
            axs[0].fill_between(
                mf[mask], mvmax, mvmin, facecolor=l.get_color(), alpha=0.3
            )

        mask = mr == np.max(mr)
        l = err_plt(axs[1], mf[mask], mv[mask], error=error)
        lines.append(l)
        labels.append(
            &quot;$\\sigma_{\\mathrm{&quot;
            + v.replace(&quot;_PLUS_&quot;, &quot;+&quot;).replace(&quot; &quot;, &quot;\\ &quot;)
            + &quot;} }$&quot;
        )
        # l, _, _ = axs[1].errorbar(mf[mask], splot.unv(mv[mask]),
        #                          yerr=splot.usd(mv[mask]), capsize=5)
        if seven_point_band:
            axs[1].fill_between(
                mf[mask], mvmax, mvmin, facecolor=l.get_color(), alpha=0.3
            )

        mask = mf == np.min(mf)
        l = err_plt(axs[2], mr[mask], mv[mask], error=error)
        # l, _, _ = axs[2].errorbar(mr[mask], splot.unv(mv[mask]),
        #                          yerr=splot.usd(mv[mask]), capsize=5)
        if seven_point_band:
            axs[2].fill_between(
                mr[mask], mvmax, mvmin, facecolor=l.get_color(), alpha=0.3
            )

        mask = mr == np.min(mr)
        l = err_plt(axs[3], mf[mask], mv[mask], error=error)
        # l, _, _ = axs[3].errorbar(mf[mask], splot.unv(mv[mask]),
        #                          yerr=splot.usd(mv[mask]), capsize=5)
        if seven_point_band:
            axs[3].fill_between(
                mf[mask], mvmax, mvmin, facecolor=l.get_color(), alpha=0.3
            )

        mask = mf == np.max(mf)
        l = err_plt(axs[4], mr[mask], mv[mask], error=error)
        # l, _, _ = axs[4].errorbar(mr[mask], splot.unv(mv[mask]),
        #                          yerr=splot.usd(mv[mask]), capsize=5)
        if seven_point_band:
            f = axs[4].fill_between(
                mr[mask], mvmax, mvmin, facecolor=l.get_color(), alpha=0.3
            )
            lines.append(f)
            labels.append(
                &quot;$\\Delta \\sigma_{\\mathrm{&quot;
                + v.replace(&quot;NLO_PLUS_NLL&quot;, &quot;NLO+NLL&quot;).replace(&quot; &quot;, &quot;\\&lt;space&gt;&quot;)
                + &quot;} }$&quot;
            )

    axs[0].set_ylabel(&quot;$\\sigma$ [&quot; + unit + &quot;]&quot; if yaxis is None else yaxis)

    axs[0].set_xscale(&quot;log&quot;)
    axs[0].set_xlim(np.min(mf), np.max(mf))
    axs[0].set_xlabel(&quot;$\\mu_{R,F}/\\mu_0$&quot;)

    # axs[1].plot(t, s2)
    axs[1].set_xscale(&quot;log&quot;)
    axs[1].set_xlim(np.max(mf), np.min(mf))
    axs[1].set_xticks([1.0])
    axs[1].xaxis.set_minor_formatter(NullFormatter())
    axs[1].set_xlabel(&quot;$\\mu_{F}/\\mu_0$&quot;)

    # axs[2].plot(t, s3)
    axs[2].set_xscale(&quot;log&quot;)
    axs[2].set_xlim(np.max(mf), np.min(mf))
    axs[2].set_xticks([1.0])
    axs[2].xaxis.set_minor_formatter(NullFormatter())
    axs[2].set_xlabel(&quot;$\\mu_{R}/\\mu_0$&quot;)

    # axs[3].plot(t, s3)
    axs[3].set_xscale(&quot;log&quot;)
    axs[3].set_xlim(np.min(mf), np.max(mf))
    axs[3].set_xticks([1.0])
    axs[3].xaxis.set_minor_formatter(NullFormatter())
    axs[3].set_xlabel(&quot;$\\mu_{F}/\\mu_0$&quot;)

    # axs[4].plot(t, s3)
    axs[4].set_xscale(&quot;log&quot;)
    axs[4].set_xlim(np.min(mf), np.max(mf))
    axs[4].set_xticks([1.0])
    axs[4].xaxis.set_minor_formatter(NullFormatter())
    axs[4].set_xlabel(&quot;$\\mu_{R}/\\mu_0$&quot;)

    axs[0].legend(handletextpad=-0.0, handlelength=0, fancybox=False)
    axs[1].legend(handletextpad=-0.0, handlelength=0, fancybox=False)
    axs[2].legend(handletextpad=-0.0, handlelength=0, fancybox=False)
    axs[3].legend(handletextpad=-0.0, handlelength=0, fancybox=False)
    axs[4].legend(handletextpad=-0.0, handlelength=0, fancybox=False)
    fig.legend()
    fig.legends = []
    fig.legend(handles=lines, labels=labels, loc=&quot;center right&quot;)
    plt.subplots_adjust(right=0.84)
    # plt.show()
    mpl.rcParams[&quot;axes.prop_cycle&quot;] = cycle_safe</div>



<div class="viewcode-block" id="central_scale_plot">
<a class="viewcode-back" href="../../../autoapi/hepi/plot/plot/index.html#hepi.central_scale_plot">[docs]</a>
def central_scale_plot(
    dict_list, vl, cont=False, error=True, yscale=1.0, unit=&quot;pb&quot;, yaxis=None
):
    &quot;&quot;&quot;Creates a scale variance plot with 3 panels (ystacked).&quot;&quot;&quot;
    global fig, axs
    if not cont:
        fig, axs = plt.subplots(3, 1, figsize=(12, 8), sharex=True)
        # Remove horizontal space between axes
        fig.subplots_adjust(hspace=0)

    mr = dict_list[&quot;mu_r&quot;]
    mf = dict_list[&quot;mu_f&quot;]

    for v in vl:
        mv = dict_list[v] * yscale

        mask = mf == mr
        l = err_plt(axs[0], mf[mask], mv[mask], label=v, error=error)

        mask = mf == 1.0
        l = err_plt(axs[1], mr[mask], mv[mask], error=error)

        mask = mr == 1.0
        l = err_plt(axs[2], mf[mask], mv[mask], error=error)

    if not cont:
        axs[0].plot([], [], &quot; &quot;, label=&quot;$\\mu_R=\\mu_F=\\mu$&quot;)
        axs[1].plot([], [], &quot; &quot;, label=&quot;$\\mu_F=\\mu_0$, $\\mu_R=\\mu$&quot;)
        axs[2].plot([], [], &quot; &quot;, label=&quot;$\\mu_R=\\mu_0$, $\\mu_F=\\mu$&quot;)

    axs[1].set_ylabel(&quot;$\\sigma$ [&quot; + unit + &quot;]&quot; if yaxis is None else yaxis)

    axs[0].set_xscale(&quot;log&quot;)
    # axs[0].set_xlim(np.min(mf), np.max(mf))
    axs[2].set_xlabel(&quot;$\\mu/\\mu_0$&quot;)

    axs[0].legend()
    axs[1].legend()
    axs[2].legend()</div>

    # plt.show()


<div class="viewcode-block" id="init_double_plot">
<a class="viewcode-back" href="../../../autoapi/hepi/plot/plot/index.html#hepi.init_double_plot">[docs]</a>
def init_double_plot(
    figsize=(6, 8), sharex=True, sharey=False, gridspec_kw={&quot;height_ratios&quot;: [3, 1]}
):
    &quot;&quot;&quot;Initialze subplot for Ratio/K plots with another figure below.&quot;&quot;&quot;
    fig, axs = plt.subplots(
        2, 1, figsize=figsize, sharex=sharex, sharey=sharey, gridspec_kw=gridspec_kw
    )
    # Remove horizontal space between axes
    fig.subplots_adjust(hspace=0)
    return fig, axs</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Alexander Puck Neuwirth.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>