<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>hepi.util &mdash; HEPi  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/jupyter-sphinx.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/thebelab.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/thebelab-helper.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> HEPi
          </a>
              <div class="version">
                0.2.0-15-g8416c58a
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Versions:</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://apn-pucky.github.io/HEPi/">Stable</a></li>
<li class="toctree-l1"><a class="reference external" href="https://apn-pucky.github.io/HEPi/test/">Dev</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Links:</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/APN-Pucky/HEPi">GitHub</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../examples/demo_resummino.html">Resummino example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/test_distribute.html">Distribute resummino run files to clusters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/test_interpolate.html">Interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/test_madgraph.html">MadGraph example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/test_pyslha.html">pyslha comparison</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/test_spheno.html">SPheno example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/test_write.html">Result writing example</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Module:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../autoapi/hepi/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">hepi</span></code></a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">HEPi</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Module code</a> &raquo;</li>
          <li><a href="../hepi.html">hepi</a> &raquo;</li>
      <li>hepi.util</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for hepi.util</h1><div class="highlight"><pre>
<span></span>&quot;&quot;&quot;Collection of utility functions for the :mod:`hepi` package.&quot;&quot;&quot;
import json
from typing import List, Tuple
import numpy as np
import hashlib
from particle.converters.bimap import DirectionalMaps
from particle import PDGID
from distutils.version import StrictVersion

import pandas as pd
import warnings
from smpl import interpolate as ip


<div class="viewcode-block" id="DictData"><a class="viewcode-back" href="../../autoapi/hepi/util/index.html#hepi.DictData">[docs]</a>class DictData:

<div class="viewcode-block" id="DictData.__str__"><a class="viewcode-back" href="../../autoapi/hepi/util/index.html#hepi.DictData.__str__">[docs]</a>    def __str__(self):
        &quot;&quot;&quot;Returns attributes as dict as string&quot;&quot;&quot;
        return str(self.__dict__)</div></div>


<div class="viewcode-block" id="LD2DL"><a class="viewcode-back" href="../../autoapi/hepi/util/index.html#hepi.LD2DL">[docs]</a>def LD2DL(l: List, actual_dict=False) -&gt; dict:
    &quot;&quot;&quot;
    Convert a list of objects into a dictionary of lists.

    The values of each object are first converted to a `dict` through the `__dict__` attribute.

    Args:
        l (List) : list of objects.
        actual_dict (bool) : objects are already dicts

    Returns:
        dict : dictionary of numpy arrays.

    Examples:
        &gt;&gt;&gt; class Param:
        ...      def __init__(self,a,b,c):
        ...         self.a = a
        ...         self.b = b
        ...         self.c = c
        &gt;&gt;&gt; LD2DL([ Param(1,2,3), Param(4,5,6) , Param(7,8,9) ])
        {&#39;a&#39;: array([1, 4, 7]), &#39;b&#39;: array([2, 5, 8]), &#39;c&#39;: array([3, 6, 9])}
    &quot;&quot;&quot;
    # Check l[0] keys in all dictionaries.
    for m in l:
        md = m if actual_dict else m.__dict__
        for k in l[0] if actual_dict else l[0].__dict__:
            assert k in md
    # switch them
    return {
        k: np.array([dic[k] if actual_dict else dic.__dict__[k] for dic in l])
        for k in (l[0] if actual_dict else l[0].__dict__)
    }</div>


<div class="viewcode-block" id="DL2DF"><a class="viewcode-back" href="../../autoapi/hepi/util/index.html#hepi.DL2DF">[docs]</a>def DL2DF(ld: dict) -&gt; pd.DataFrame:
    &quot;&quot;&quot;
    Convert a `dict` of `list`s to a `pandas.DataFrame`.
    &quot;&quot;&quot;
    return pd.DataFrame.from_dict(ld)</div>


PDG2LaTeXNameMap, LaTeX2PDGNameMap = DirectionalMaps(&quot;PDGID&quot;,
                                                     &quot;LaTexName&quot;,
                                                     converters=(PDGID, str))

PDG2Name2IDMap, PDGID2NameMap = DirectionalMaps(&quot;PDGName&quot;,
                                                &quot;PDGID&quot;,
                                                converters=(str, PDGID))


<div class="viewcode-block" id="get_name"><a class="viewcode-back" href="../../autoapi/hepi/util/index.html#hepi.get_name">[docs]</a>def get_name(pid: int) -&gt; str:
    &quot;&quot;&quot;
    Get the latex name of a particle.

    Args:
        pid (int) : PDG Monte Carlo identifier for the particle.

    Returns:
        str: Latex name.

    Examples:
        &gt;&gt;&gt; get_name(21)
        &#39;g&#39;
        &gt;&gt;&gt; get_name(1000022)
        &#39;\\\\tilde{\\\\chi}_{1}^{0}&#39;
    &quot;&quot;&quot;
    global PDG2LaTeXNameMap
    pdgid = PDG2LaTeXNameMap[pid]
    return pdgid</div>


<div class="viewcode-block" id="get_LR_partner"><a class="viewcode-back" href="../../autoapi/hepi/util/index.html#hepi.get_LR_partner">[docs]</a>def get_LR_partner(pid: int) -&gt; Tuple[int, int]:
    &quot;&quot;&quot;Transforms a PDG id to it&#39;s left-right partner.

    Args:
        pid (int) : PDG Monte Carlo identifier for the particle.

    Returns:
        tuple : First int is -1 for Left and 1 for Right. Second int is the PDG id.

    Examples:
        &gt;&gt;&gt; get_LR_partner(1000002)
        (-1, 2000002)
    &quot;&quot;&quot;
    n = PDGID2NameMap[pid]
    if &quot;L&quot; in n:
        n = n.replace(&quot;L&quot;, &quot;R&quot;)
        return -1, int(PDG2Name2IDMap[n])
    if &quot;R&quot; in n:
        n = n.replace(&quot;R&quot;, &quot;L&quot;)
        return 1, int(PDG2Name2IDMap[n])
    if &quot;1&quot; in n:
        n = n.replace(&quot;1&quot;, &quot;2&quot;)
        return -1, int(PDG2Name2IDMap[n])
    if &quot;2&quot; in n:
        n = n.replace(&quot;2&quot;, &quot;1&quot;)
        return 1, int(PDG2Name2IDMap[n])
    return None</div>


<div class="viewcode-block" id="namehash"><a class="viewcode-back" href="../../autoapi/hepi/util/index.html#hepi.namehash">[docs]</a>def namehash(n: any) -&gt; str:
    &quot;&quot;&quot;
    Creates a sha256 hash from the objects string representation.

    Args:
        n (any) : object.

    Returns:
        str: sha256 of object.

    Examples:
        &gt;&gt;&gt; p = {&#39;a&#39;:1,&#39;b&#39;:2}
        &gt;&gt;&gt; str(p)
        &quot;{&#39;a&#39;: 1, &#39;b&#39;: 2}&quot;
        &gt;&gt;&gt; namehash(str(p))
        &#39;3dffaea891e5dbadb390da33bad65f509dd667779330e2720df8165a253462b8&#39;
        &gt;&gt;&gt; namehash(p)
        &#39;3dffaea891e5dbadb390da33bad65f509dd667779330e2720df8165a253462b8&#39;
    &quot;&quot;&quot;
    m = hashlib.sha256()
    m.update(str(n).encode(&#39;utf-8&#39;))
    return m.hexdigest()</div>

<div class="viewcode-block" id="import_lhapdf"><a class="viewcode-back" href="../../autoapi/hepi/util/index.html#hepi.import_lhapdf">[docs]</a>def import_lhapdf() -&gt; bool:
    try:
        import lhapdf
        if StrictVersion(lhapdf.__version__) &gt;= StrictVersion(&#39;6.3.0&#39;):
            return lhapdf
        else:
            warnings.warn(&quot;LHAPDF&gt;=6.3.0 version required&quot;)
            return None
    except ImportError:
        warnings.warn(&quot;LHAPDF python binding not installed?&quot;)
        return None</div>

<div class="viewcode-block" id="lhapdf_name_to_id"><a class="viewcode-back" href="../../autoapi/hepi/util/index.html#hepi.lhapdf_name_to_id">[docs]</a>def lhapdf_name_to_id(name: str) -&gt; int:
    &quot;&quot;&quot;
    Converts a LHAPDF name to the sets id.

    Args:
        name (str) : LHAPDF set name.

    Returns:
        int: id of the LHAPDF set.

    Examples:
        &gt;&gt;&gt; lhapdf_name_to_id(&quot;CT14lo&quot;)
        13200
    &quot;&quot;&quot;
    lhapdf = import_lhapdf()
    if lhapdf is None: return 0
    if not name in lhapdf.availablePDFSets():
        warnings.warn(&quot;PDF set &#39;&quot; + name + &quot;&#39; not installed?&quot;)
        return 0
    return lhapdf.getPDFSet(name).lhapdfID</div>

<div class="viewcode-block" id="lhapdf_id_to_name"><a class="viewcode-back" href="../../autoapi/hepi/util/index.html#hepi.lhapdf_id_to_name">[docs]</a>def lhapdf_id_to_name(lid : int) -&gt; str:
    lhapdf = import_lhapdf()
    if lhapdf is None: return &quot;&quot;
    for n in lhapdf.availablePDFSets():
        if lhapdf.getPDFSet(n).lhapdfID == lid:
            return n
        
    warnings.warn(&quot;PDF set with id &quot; + str(lid) + &quot; unknown/uninstalled?&quot;)
    return &quot;Unknown PDF ID: &quot; + str(lid)</div>

# TODO fix dependent(mu) for new masses

<div class="viewcode-block" id="interpolate_1d"><a class="viewcode-back" href="../../autoapi/hepi/util/index.html#hepi.interpolate_1d">[docs]</a>def interpolate_1d(df,x,y,xrange,only_interpolation=True):
    &quot;&quot;&quot;
    Last key is the value to be interpolated, while the rest are cooridnates.
    
    Args:
        df (pandas.DataFrame): results
    &quot;&quot;&quot;
    f = ip.interpolate(df[x],df[y])
    a = []
    for xr in xrange:
        c = df.head(1)
        c[x] = xr
        c[y] = f(xr)
        a += [c]
    if only_interpolation:
        return pd.concat(a)
    else:
        return pd.concat([df, *a])</div>
 
<div class="viewcode-block" id="interpolate_2d"><a class="viewcode-back" href="../../autoapi/hepi/util/index.html#hepi.interpolate_2d">[docs]</a>def interpolate_2d(df,x,y,z,xrange,yrange,only_interpolation=True,**kwargs):
    &quot;&quot;&quot;
    Last key is the value to be interpolated, while the rest are cooridnates.
    
    Args:
        df (pandas.DataFrame): results
    &quot;&quot;&quot;
    f = ip.interpolate(df[x],df[y],df[z],**kwargs)
    a = []
    for i in range(len(xrange)):
        xr = xrange[i]
        yr = yrange[i]
        zr = f(xr,yr)
        c = df.head(1).copy()
        c[x] = xr
        c[y] = yr
        c[z] = zr
        a += [c]
    if only_interpolation:
        return pd.concat(a)
    else:
        return pd.concat([df, *a])</div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, APN-Pucky.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>